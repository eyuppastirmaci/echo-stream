<div class="chat-container">
  <header class="chat-header">
    <h1>EchoStream Chat</h1>
    <div class="user-info">
      @if (currentUser()) {
        <span>Welcome, {{ currentUser() }}!</span>
      } @else {
        <span>Setting up chat...</span>
      }
    </div>
  </header>

  <main class="chat-main">
    @if (currentUser() && otherUser()) {
      <div class="conversation-header">
        <h2>Conversation with {{ otherUser() }}</h2>
      </div>
    } @else {
      <div class="conversation-header">
        <h2>Initializing chat...</h2>
      </div>
    }
    <div class="chat-messages" #messagesContainer>
      @for (message of messages(); track message.id) {
        <div class="message" [class.own-message]="message.senderId === currentUser()">
          <div class="message-content">
            <div class="message-text">{{ message.content }}</div>
            <div class="message-time">{{ message.timestamp | date:"short" }}</div>
          </div>
        </div>
      } @empty {
        <div class="empty-state">
          <p>No messages yet. Start the conversation!</p>
        </div>
      }
    </div>

    <div class="message-input-container">
      <div class="message-input">
        <input
          type="text"
          [(ngModel)]="newMessage"
          (keyup.enter)="sendMessage()"
          [placeholder]="APP_CONFIG.MESSAGE_INPUT_PLACEHOLDER"
          [disabled]="isConnected() === false">
        <button
          (click)="sendMessage()"
          [disabled]="!newMessage.trim() || isConnected() === false"
          class="send-button">
          {{ APP_CONFIG.SEND_BUTTON_TEXT }}
        </button>
      </div>
      <div class="connection-status" [class.connected]="isConnected()">
        {{ isConnected() ? "Connected" : "Disconnected" }}
        @if (!isConnected()) {
          <button (click)="reconnect()" class="reconnect-btn">Reconnect</button>
        }
      </div>
    </div>
  </main>
</div>
